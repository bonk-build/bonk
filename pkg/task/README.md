<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# task

```go
import "go.bonk.build/pkg/task"
```

Package task contains the core structures needed define a bonk pipeline. For more information, see [Task](<#Task>), and \[Executor\].

## Index

- [Constants](<#constants>)
- [func OutputFS\(session Session, id ID\) afero.Fs](<#OutputFS>)
- [func TaskIDMatches\(id ID\) gomock.Matcher](<#TaskIDMatches>)
- [type DefaultSession](<#DefaultSession>)
  - [func \(ds \*DefaultSession\) ID\(\) SessionID](<#DefaultSession.ID>)
  - [func \(ds \*DefaultSession\) OutputFS\(\) afero.Fs](<#DefaultSession.OutputFS>)
  - [func \(ds \*DefaultSession\) SourceFS\(\) afero.Fs](<#DefaultSession.SourceFS>)
- [type ID](<#ID>)
  - [func NewID\(parts ...string\) ID](<#NewID>)
  - [func \(id ID\) Cut\(\) \(string, string, bool\)](<#ID.Cut>)
  - [func \(id ID\) GetChild\(names ...string\) ID](<#ID.GetChild>)
  - [func \(id ID\) String\(\) string](<#ID.String>)
- [type LocalSession](<#LocalSession>)
  - [func NewLocalSession\(id SessionID, localPath string\) LocalSession](<#NewLocalSession>)
- [type Option](<#Option>)
  - [func WithDependencies\(dependencies ...ID\) Option](<#WithDependencies>)
  - [func WithInputs\(inputs ...string\) Option](<#WithInputs>)
- [type Result](<#Result>)
- [type Session](<#Session>)
  - [func NewTestSession\(\) Session](<#NewTestSession>)
- [type SessionID](<#SessionID>)
  - [func NewSessionID\(\) SessionID](<#NewSessionID>)
- [type Task](<#Task>)
  - [func New\(id ID, executor string, args any, options ...Option\) \*Task](<#New>)


## Constants

<a name="TaskIDSep"></a>TaskIDSep is the string placed between parts of a hierarchical [ID](<#ID>).

```go
const TaskIDSep = "."
```

<a name="OutputFS"></a>
## func [OutputFS](<session.go#L30>)

```go
func OutputFS(session Session, id ID) afero.Fs
```

OutputFS returns the output filesystem for the given task.

<a name="TaskIDMatches"></a>
## func [TaskIDMatches](<testing.go#L38>)

```go
func TaskIDMatches(id ID) gomock.Matcher
```



<a name="DefaultSession"></a>
## type [DefaultSession](<session.go#L43-L47>)

DefaultSession is a default implementation of Session that stores its parameters in members.

```go
type DefaultSession struct {
    Id       SessionID //nolint:revive
    SourceFs afero.Fs
    OutputFs afero.Fs
}
```

<a name="DefaultSession.ID"></a>
### func \(\*DefaultSession\) [ID](<session.go#L55>)

```go
func (ds *DefaultSession) ID() SessionID
```

ID returns a unique identifier per\-session.

<a name="DefaultSession.OutputFS"></a>
### func \(\*DefaultSession\) [OutputFS](<session.go#L65>)

```go
func (ds *DefaultSession) OutputFS() afero.Fs
```

OutputFS returns an \[afero.Fs\] referring to session's output directory.

<a name="DefaultSession.SourceFS"></a>
### func \(\*DefaultSession\) [SourceFS](<session.go#L60>)

```go
func (ds *DefaultSession) SourceFS() afero.Fs
```

SourceFS returns an \[afero.Fs\] referring to the sesion root.

<a name="ID"></a>
## type [ID](<id.go#L14>)

ID represents is a way to address an individual task.

```go
type ID string
```

<a name="NewID"></a>
### func [NewID](<id.go#L17>)

```go
func NewID(parts ...string) ID
```

NewID creates a new TaskID from a series of parts.

<a name="ID.Cut"></a>
### func \(ID\) [Cut](<id.go#L33>)

```go
func (id ID) Cut() (string, string, bool)
```

Cut is a helper for calling [strings.Cut](<https://pkg.go.dev/strings/#Cut>).

<a name="ID.GetChild"></a>
### func \(ID\) [GetChild](<id.go#L26>)

```go
func (id ID) GetChild(names ...string) ID
```

GetChild returns a new TaskID which is a child of the current one.

<a name="ID.String"></a>
### func \(ID\) [String](<id.go#L21>)

```go
func (id ID) String() string
```



<a name="LocalSession"></a>
## type [LocalSession](<session.go#L35-L40>)

LocalSession is a session that is being executed on the local machine.

```go
type LocalSession interface {
    Session

    // LocalPath() returns the absolute path to the root of the project on disk.
    LocalPath() string
}
```

<a name="NewLocalSession"></a>
### func [NewLocalSession](<session.go#L78>)

```go
func NewLocalSession(id SessionID, localPath string) LocalSession
```

NewLocalSession creates a session describing a project source on the current local machine.

<a name="Option"></a>
## type [Option](<task.go#L21>)



```go
type Option func(*Task)
```

<a name="WithDependencies"></a>
### func [WithDependencies](<task.go#L51>)

```go
func WithDependencies(dependencies ...ID) Option
```

WithDependencies appends input specifiers to this task.

<a name="WithInputs"></a>
### func [WithInputs](<task.go#L44>)

```go
func WithInputs(inputs ...string) Option
```

WithInputs appends input specifiers to this task.

<a name="Result"></a>
## type [Result](<result.go#L7-L12>)

Result describes the outputs of a task's execution.

```go
type Result struct {
    // Outputs describes any files that have been emitted by the task relative to [Session.OutputFS].
    Outputs []string `json:"outputs"`
    // FollowupTasks is a list of tasks to be executed after this task completes.
    FollowupTasks []Task `json:"followupTasks"`
}
```

<a name="Session"></a>
## type [Session](<session.go#L20-L27>)

Session defines a context in which tasks are invoked.

```go
type Session interface {
    // ID() returns a unique identifier per-session.
    ID() SessionID
    // SourceFS() returns a filesystem describing the root of the project consumed by the session.
    SourceFS() afero.Fs
    // OutputFS() returns a filesystem where output files may be written.
    OutputFS() afero.Fs
}
```

<a name="NewTestSession"></a>
### func [NewTestSession](<testing.go#L20>)

```go
func NewTestSession() Session
```

NewTestSession creates a session suitable for testing, with an in\-memory file system.

<a name="SessionID"></a>
## type [SessionID](<session.go#L12>)

SessionID is a unique identifier per\-session.

```go
type SessionID = uuid.UUID
```

<a name="NewSessionID"></a>
### func [NewSessionID](<session.go#L15>)

```go
func NewSessionID() SessionID
```

NewSessionID creates a new unique session identifier which may be sorted in order of creation time.

<a name="Task"></a>
## type [Task](<task.go#L7-L19>)

Task represents a unit of work to be executed.

```go
type Task struct {
    // ID describes how this task is addressed.
    ID  ID  `json:"id"`
    // Executor describes where to route this task for execution.
    Executor string `json:"executor"`

    // Inputs describes any files that may be consumed by this task (relative to [Session.SourceFS]).
    Inputs []string `json:"inputs,omitempty"`
    // Dependencies contains a list of tasks which must be completed before this task can run.
    Dependencies []ID `json:"dependencies,omitempty"`
    // Args contains any arguments that may be passed to the executor.
    Args any `json:"args"`
}
```

<a name="New"></a>
### func [New](<task.go#L24-L29>)

```go
func New(id ID, executor string, args any, options ...Option) *Task
```

New creates a new task with the given parameters.

Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
