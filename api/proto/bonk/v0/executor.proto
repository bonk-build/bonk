// Copyright Â© 2025 Colden Cullen
// SPDX-License-Identifier: MIT

edition = "2023";
package bonk.v0;

import "google/protobuf/struct.proto";

message OpenSessionRequest {
  message WorkspaceDescriptionLocal {
    string absolute_path = 1;
  }

  string session_id = 1;

  oneof workspace_description {
    WorkspaceDescriptionLocal local = 2;
  }
}

message OpenSessionResponse {}

message CloseSessionRequest {
  string session_id = 1;
}

message CloseSessionResponse {}

message ExecuteTaskRequest {
  string session_id = 1;
  string name = 2;
  string executor = 3;
  repeated string inputs = 4;
  google.protobuf.Struct parameters = 5;
}

message ExecuteTaskResponse {
  message FollowupTask {
    string name = 1;
    string executor = 2;
    repeated string inputs = 3;
    google.protobuf.Struct parameters = 4;
  }

  repeated string output = 1;
  repeated FollowupTask followup_tasks = 2;
}

service ExecutorService {
  // Used for opening & closing sessions
  rpc OpenSession(OpenSessionRequest) returns (OpenSessionResponse);
  rpc CloseSession(CloseSessionRequest) returns (CloseSessionResponse);

  // Executor interface
  rpc ExecuteTask(ExecuteTaskRequest) returns (ExecuteTaskResponse);
}
